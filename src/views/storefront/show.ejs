<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title><%= pageTitle ? `${pageTitle}` : `${store.displayName} • ${appName || 'Plataforma'}` %></title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet"
    />
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous"
    />
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
        rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/storefront.css" />
</head>
<body class="storefront-body">
    <header class="storefront-hero store-hero">
        <div class="container">
            <div class="store-hero__top">
                <a href="/store" class="back-link"><i class="bi bi-arrow-left"></i> Voltar para lojas</a>
                <span class="badge-soft">Multi-loja</span>
            </div>
            <div class="row align-items-center g-4">
                <div class="col-lg-7">
                    <h1 class="store-hero__title"><%= store.displayName %></h1>
                    <p class="store-hero__subtitle"><%= store.heroSubtitle %></p>
                    <div class="store-hero__meta">
                        <% if (store.city || store.state) { %>
                            <span><i class="bi bi-geo-alt"></i><%= [store.city, store.state].filter(Boolean).join(' • ') %></span>
                        <% } %>
                        <% if (store.contactPhone) { %>
                            <span><i class="bi bi-telephone"></i><%= store.contactPhone %></span>
                        <% } %>
                        <% if (store.contactEmail) { %>
                            <span><i class="bi bi-envelope"></i><%= store.contactEmail %></span>
                        <% } %>
                    </div>
                </div>
                <div class="col-lg-5">
                    <div class="store-hero__card card border-0 shadow-sm">
                        <div class="d-flex align-items-center gap-3 mb-3">
                            <div class="featured-icon"><i class="bi bi-fire"></i></div>
                            <div>
                                <span class="text-muted d-block small">Produto destaque</span>
                                <strong class="d-block"><%= store.featuredProduct ? store.featuredProduct.name : 'Selecione um item' %></strong>
                            </div>
                        </div>
                        <% if (store.featuredProduct) { %>
                            <div class="featured-product">
                                <% if (store.featuredProduct.imageUrl) { %>
                                    <img src="<%= store.featuredProduct.imageUrl %>" alt="<%= store.featuredProduct.name %>" />
                                <% } else { %>
                                    <div class="image-placeholder"><i class="bi bi-image"></i></div>
                                <% } %>
                                <div class="featured-product__info">
                                    <span class="price"><%= store.featuredProduct.priceLabel || 'Sob consulta' %></span>
                                    <span class="availability <%= store.featuredProduct.isOutOfStock ? 'text-danger' : store.featuredProduct.isLowStock ? 'text-warning' : 'text-success' %>">
                                        <i class="bi bi-circle-fill"></i>
                                        <%= store.featuredProduct.availability %>
                                    </span>
                                </div>
                            </div>
                        <% } else { %>
                            <p class="text-muted mb-0">Cadastre produtos ativos para destacá-los automaticamente aqui.</p>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="storefront-main store-grid">
        <div class="container">
            <div class="section-header">
                <div>
                    <span class="section-chip"><i class="bi bi-bag"></i>Produtos</span>
                    <h2 class="section-title">Catálogo completo</h2>
                </div>
                <div class="section-meta">
                    <i class="bi bi-box-seam"></i>
                    <span><%= store.productCount %> item<%= store.productCount === 1 ? '' : 's' %> disponível<%= store.productCount === 1 ? '' : 's' %></span>
                </div>
            </div>

            <% if (!store.products.length) { %>
                <div class="empty-state text-center">
                    <i class="bi bi-clipboard-x"></i>
                    <h3 class="mt-3">Nenhum produto publicado</h3>
                    <p class="text-muted mb-0">Solicite à equipe responsável para disponibilizar os itens desta loja.</p>
                </div>
            <% } else { %>
                <div class="row g-4">
                    <% store.products.forEach((product) => { %>
                        <div class="col-md-6 col-xl-4">
                            <article class="product-card">
                                <div class="product-card__media">
                                    <% if (product.imageUrl) { %>
                                        <img src="<%= product.imageUrl %>" alt="<%= product.name %>" loading="lazy" />
                                    <% } else { %>
                                        <div class="image-placeholder"><i class="bi bi-image"></i></div>
                                    <% } %>
                                    <% if (product.isOutOfStock) { %>
                                        <span class="product-card__badge badge-danger">Indisponível</span>
                                    <% } else if (product.isLowStock) { %>
                                        <span class="product-card__badge badge-warning">Poucas unidades</span>
                                    <% } else { %>
                                        <span class="product-card__badge badge-success">Disponível</span>
                                    <% } %>
                                </div>
                                <div class="product-card__body">
                                    <h3 class="product-card__title"><%= product.name %></h3>
                                    <p class="product-card__summary"><%= product.summary %></p>
                                    <div class="product-card__pricing">
                                        <span class="price"><%= product.priceLabel || 'Sob consulta' %></span>
                                        <% if (product.compareAtLabel) { %>
                                            <span class="compare-price"><%= product.compareAtLabel %></span>
                                        <% } %>
                                    </div>
                                </div>
                                <div class="product-card__footer">
                                    <span class="stock">
                                        <i class="bi bi-stack"></i>
                                        <%= product.stockQuantity %> em estoque
                                    </span>
                                    <button class="btn btn-outline-primary" type="button" disabled>
                                        Comprar em breve
                                        <i class="bi bi-lock ms-2"></i>
                                    </button>
                                </div>
                            </article>
                        </div>
                    <% }) %>
                </div>
            <% } %>
        </div>
    </main>

    <footer class="storefront-footer">
        <div class="container text-center">
            <p class="mb-1">© <%= new Date().getFullYear() %> <%= appName || 'Plataforma' %>. Ambiente seguro e monitorado.</p>
            <% if (store.website) { %>
                <p class="text-muted small mb-0">
                    <i class="bi bi-globe me-1"></i>
                    <a href="<%= store.website %>" target="_blank" rel="noopener" class="link-light">Visitar site institucional</a>
                </p>
            <% } else { %>
                <p class="text-muted small mb-0">Proteção de dados e alta disponibilidade garantidas.</p>
            <% } %>
        </div>
    </footer>
</body>
</html>
